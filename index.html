<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <title>TA FORM</title>
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5314158636254894"
     crossorigin="anonymous"></script>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CH22M8QX1L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-CH22M8QX1L');
</script>
  <style>
    @page {
      size: A4;
      margin: 4mm;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }
    .a4-page {
      width: 210mm;
      min-height: 297mm;
      padding: 5mm;
      margin: 5px auto;
      box-sizing: border-box;
      background-color: white;
      border: 0px solid #ccc;
      box-shadow: 0 0 05px rgba(0, 0, 0, 0.1);
      position: relative;
      height: auto; /* कंटेंट के अनुसार लम्बा होगा */
    }
    /* ********** आपकी मूल Absolute Positions ********** */
    .header-left { position: absolute; top: 6mm; left: 6mm; font-weight: normal; font-size: 16px; }
    .sub-bill-left { position: absolute; top: 10mm; left: 6mm; font-weight: normal; font-size: 14px; }
    .header-center { position: absolute; top: 6mm; left: 52%; transform: translateX(-50%); font-weight: normal; font-size: 16px; }
    .header-right { position: absolute; top: 6mm; right: 6mm; font-weight: normal; font-size: 14px; }
    
    .positioned-line { border: none; border-top: 0.5px dotted black; height: 0; background-color: transparent; width: 100%; margin-top: 1px; margin-bottom: 20px; margin-left: auto; margin-right: 0; }
    .dotted-line1 { border: none; border-top: 0.5px dotted black; height: 0; width: 390%; margin: 0px auto; margin-left: auto; margin-right: 0; }
    
    /* तालिका कंटेनर और बटन */
    #customTable { position:absolute; top: 110mm; left: 0mm; border-collapse: collapse; width: 98%; }
    
    /* ******** बटन इनलाइन फिक्स ******** */
    .action-buttons {
        position: absolute; 
        left: 2mm;
        width: 100%; 
        padding: 5px 0;
        display: flex; 
        flex-wrap: wrap;
        justify-content: flex-start; 
        align-items: center;
    }
    .action-buttons button {
        margin-right: 10px; 
        margin-bottom: 5px; 
    }
    /* ********************************* */

    /* === TABLE CSS === */
    [contenteditable]:empty::before { content: attr(data-placeholder); color: #999; font-style: italic; pointer-events: none; }
    #customTable td { 
        white-space: normal; 
        word-wrap: break-word; 
        word-break: break-all; 
        overflow: hidden; 
        height: auto; 
        text-align: left; 
        vertical-align: top ; 
        padding: 3px; 
        box-sizing: border-box; 
        line-height: 1.2; 
        border: 0.5px solid black !important; 
        min-width: 60px; 
    }
    #customTable th { border: 0.5px solid black; font-size: 12px; }
    
    /* चौड़ाई सेटिंग्स */
    #cell-4-1, #cell-4-3, #customTable tr td:nth-child(1), #customTable tr td:nth-child(3) { width: 78px; min-width: 80px; max-width: 80px; text-align: center; }
    #cell-4-2, #cell-4-4, #customTable tr td:nth-child(2), #customTable tr td:nth-child(4) { width: 115px; min-width: 100px;}
    #cell-4-5, #customTable tr td:nth-child(5) { width: 28px; min-width: 30px; text-align: center; }
    #cell-4-6, #customTable tr td:nth-child(6) { width: 30px; min-width: 30px; text-align: center; } 
    #cell-4-7, #customTable tr td:nth-child(8) { width: 25px; min-width: 25px; text-align: center; }
    #cell-4-8, #customTable tr td:nth-child(9) { width: 25px; min-width: 25px; text-align: center; }
    #cell-4-9 { width: 50px; min-width: 50px; vertical-align: top !important; }
    #customTable tr[data-deletable="true"] td[colspan="9"] { width: 85%; min-width: 85%; }
    
    /* टोटल रो स्टाइल (प्रिंट-फ्रेंडली फिक्स) */
    .total-row td {
        font-weight: bold;
        background-color: transparent !important; 
        border-bottom: 2px solid black !important; 
    }
    .total-row:last-child td {
         border-bottom: 2px solid black !important;
    }

    /* नयी CSS इमेज के लिए */

    .a4-image-page {
      width: 210mm;
      height: 297mm;
      margin: 0 auto;
      background: white;
      overflow: hidden;
    }

    .page-break {
      display: block;
      page-break-before: always;
    }

    @media print {
      .a4-page {
        page-break-after: always;
      }
      .a4-image-page {
        page-break-before: always;
        page-break-after: always;
        width: 210mm !important;
        height: 297mm !important;
        margin: 0 !important;
        background: white !important;
      }
      .action-buttons {
        display: none !important;
      }
    }
  </style>
</head>
<body>
    
    <div id="instructionModal" style="
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%; 
    background-color: rgba(0, 0, 0, 0.75); 
    display: none; 
    justify-content: center; 
    align-items: center; 
    z-index: 10000;
    padding: 20px;
">
  <div style="
      background: linear-gradient(135deg, #4caf50, #087f23);
      padding: 40px 30px;
      border-radius: 12px;
      max-width: 480px;
      width: 90%;
      color: white;
      box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: left;
  ">
    <h2 style="
      margin-top: 0; 
      font-size: 28px; 
      font-weight: 700; 
      text-align: center;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.4);
    ">फार्म भरने के निर्देश (Instructions)</h2>
    <p style="font-size: 18px; line-height: 1.5; margin-bottom: 20px;">
      यह यात्रा भत्ता बिल (TA Bill) फॉर्म एक इंटरैक्टिव टूल है। कृपया ध्यान दें :
    </p>
    <ul style="font-size: 16px; line-height: 1.6; padding-left: 25px; margin-bottom: 25px;">
      <li>सभी संबंधित फ़ील्ड्स (जैसे नाम, वेतन, पद, तिथि और समय) सावधानी से भरें।</li>
      <li>यात्रा विवरण तालिका में तारीख और समय <strong>DD.MM.YY HH:MM</strong> फॉर्मेट में भरें।</li>
      <li>राशि (Amount) कॉलम में केवल संख्या और दशमलव अंक दर्ज करें।</li>
      <li>नया यात्रा विवरण या विश्राम विवरण जोड़ने के लिए नीचे दिए गए <strong>बटन</strong> का उपयोग करें।</li>
      <li>सभी विवरण सही भरने के बाद <strong>'PDF डाउनलोड करें'</strong> बटन पर क्लिक करें।</li>
    </ul>
    <div style="text-align: center;">
      <button id="closeModalButton" style="
          padding: 14px 36px; 
          background-color: #ffd600;
          color: #222;
          font-size: 18px; 
          font-weight: 600;
          border: none; 
          border-radius: 8px;
          cursor: pointer;
          box-shadow: 0 4px 10px rgba(0,0,0,0.15);
          transition: background-color 0.3s ease;
      " 
      onmouseover="this.style.backgroundColor='#ffea00'"
      onmouseout="this.style.backgroundColor='#ffd600'">समझ गया / OK</button>
    </div>
  </div>
</div><div class="a4-page" id="a4Page">

    <div class="header-left">उप बिल संख्या...</div>
    <div class="sub-bill-left">Sub Bill No....</div>
    <div style="position: absolute; top: 10mm; right: 6mm; font-weight: normal; font-size: 14px;">I.T.B.P.F Accts 001</div>

    <div class="header-center">
        AC/NO - <input type="number" maxlength="15" pattern="d{0,15}" title="..." inputmode="numeric" style="width: 180px; height: 18px; padding: 2px 5px; font-size: 14px; border: none; outline: none;" placeholder="खाता संख्या (Account No.)" />
    </div>

    <div style="position: absolute; top: 11mm; left: 50%; transform: translateX(-50%); font-weight: normal; font-size: 16px;">
        IFSC CODE - <input type="text" maxlength="15" pattern="[A-Z0-9]{0,15}" title="..." style="width: 150px; height: 18px; padding: 2px 5px; font-size: 14px; border: none; outline: none; text-transform: uppercase;" placeholder="बैंक का IFSC कोड" />
    </div>

    <div style="position: absolute; top: 16mm; left: 50%; transform: translateX(-50%); font-weight: normal; font-size: 16px;">
        VENDOR ID - <input type="text" maxlength="15" pattern="[A-Z0-9]{0,15}" title="..." style="width: 165px; height: 18px; padding: 2px 5px; font-size: 14px; border: none; outline: none; text-transform: uppercase;" placeholder="वेंडर आई.डी. (Vendor ID)" />
    </div>

    <div style="position: absolute; top: 23mm; left: 50%; transform: translateX(-50%); text-align: center; font-weight: bold;">
      <div style="font-size: 22px;">दौरे के लिये यात्रा भत्ता बिल</div>
      <div style="font-size: 18px; margin-top: 1px;">TRAVELLING ALLOWANCE BILL FOR TOUR</div>
    </div>

    <div class="header-right">भा.ति.सी.पु.बल.लेखा001</div>

    <div style="position: absolute; top: 37mm; left: 6mm; font-weight: normal; font-size: 14px; line-height: 1.4;">
      टिप्पणी- इस बिल की दो प्रतियों में, एक संदाय के लिये और दूसरी कार्यालय प्रति के रूप में तैयार किया जाना चाहिये |<br />
      Note- This bill should be prepared in duplicate, one for payment and the other as office copy.
    </div>

    <div style="position: absolute; top: 47mm; left: 50%; transform: translateX(-50%); font-weight: bold; font-size: 16px; text-align: center;">
      भाग-क (सरकारी सेवक द्वारा भरा जाना है)<br />
      PART-A (To be filled up by Government Servant)
    </div>
    
    <div style="position: absolute; top: 60mm; left: 6mm; width: 88%; font-size: 16px;">
      
      <div style="position: absolute; top: 2mm; left: 0mm;line-height:0.8;">
        1.&nbsp;नाम<br>
        NAME -
        <input type="text" maxlength="30" style="width: 300px; height: 18px; padding: 2px 5px; font-size: 16px; border: none;font-weight : normal ;  outline: none; text-transform: uppercase;" placeholder="पूरा नाम (Full Name)" />
      </div>
      
      <div style="position: absolute; top: 1mm; left: 400px;line-height:0.8;">
        2.दल संख्या<br />
        Regimental No -
        <input type="text" maxlength="9" class="regimental-no" inputmode="numeric" style="width: 120px; font-weight : bold ; height: 18px; padding: 2px 5px; font-size: 16px; border: none; outline: none; text-align: left;" oninput="this.value=this.value.replace(/[^0-9]/g,'');" placeholder="(e.g.123456789)" />
      </div>
      
    </div>

    <div style="position: absolute; top: 71mm; left: 6mm; width: 88%; font-size: 14px;">
        
        <div style="position: absolute; top: 0mm; left: 0mm;line-height:0.8;">
            3.&nbsp; पद<br />Designation -
            <input type="text" maxlength="9" style="width: 120px; height: 18px; padding: 2px 5px; font-size: 16px; border: none; outline: none; text-transform: uppercase;" placeholder="पद Rank/Post" />
        </div>
      <div style="position: absolute; top: 1mm;line-height:0.9; left: 80mm;">
            कंपनी<br>COY -
            <input type="text" maxlength="10" inputmode="text" style="width: 116px; height: 18px; padding: 2px 5px; font-size: 18px; border: none; outline: none; text-transform: uppercase;" placeholder="ADM" />
        </div>
        <div style="position: absolute; top: 11mm; left: 0mm;line-height:0.8;">
            4.&nbsp;वेतन<br />&nbsp;&nbsp;&nbsp;PAY -
            <input type="number" maxlength="10" inputmode="numeric"pattern="[0-9]*" style="width: 110px; height: 18px; padding: 2px 5px; font-size: 16px; border: none; outline: none; text-transform: uppercase;" placeholder="₹ 00000" />
        </div>

        <div style="position: absolute; top: 11mm;line-height:0.9; left: 50mm;">
            लेवल<br />LEVEL -
            <input type="number" maxlength="2" inputmode="numeric" style="width: 60px; height: 18px; padding: 2px 5px; font-size: 18px; border: none; outline: none; text-transform: uppercase;" placeholder="01-18" />
        </div>
        
        <div style="position: absolute; top: 20mm; left: 0mm; width: 750px; font-weight: normal; font-size: 58px; display: flex; align-items: center;">
            <label for="headquarters" style="margin-right: 10px; font-size: 14px;">
              5.मुख्यालय/Headquarters</label>
            <input type="text" id="headquarters" maxlength="60" style="flex-grow: 1; height:20px; padding: 2px 5px; font-size: 16px; border: 0.5px solid #000; outline: none; text-transform: uppercase;" title="कृपया 60 अक्षरों तक दर्ज करें" placeholder="वर्तमान मुख्यालय का नाम" />
        </div>

        <div style="position: absolute; top: 25mm; left: 0mm; width: 750px; font-weight: normal; font-size: 12px; display: flex; align-items: center;">
            <label for="info" style="margin-right: 5px;">
                <p style="font-size: 10px; margin: 0 0 5px 0;">की गई यात्रा/यात्राओं के व्यौरे और प्रयोजन:<br>Details and purpose of journey(s) performed.</p>
            </label>
            <input type="text" id="info" maxlength="50" style="width: 100%; height: 25px; padding: 2px 5px; font-size: 18px; border: 0.5px solid #000; outline: none; box-sizing: border-box; text-transform: uppercase; text-align: left;" placeholder="उद्देश्य और गंतव्य ( Purpose & Destination)" />
        </div>
    </div>
    

    <table id="customTable">
     <tr>
      <th id="cell-1-1" colspan="2" style="border: 0.5px solid black;font-size: 12px;">प्रस्थान<br>Departure</th>
      <th id="cell-1-3" colspan="2" style="border: 0.5px solid black;font-size: 12px;">आगमन<br> Arrival</th>
      <th id="cell-1-4" rowspan="3"style="border: 0.5px solid black;text-align: center;font-size: 12px;"> यात्रा की एवं<br> स्थान सुब्धा का वर्ग<br> Mode of travel <br>and class of <br>accommodation</th>
      <th id="cell-1-5" colspan="2"rowspan="2"style="border: 0.5px solid black;text-align: center; vertical-align: middle;font-size: 12px;">सदत्त यात्री भाड़ा <br>Fare Paid</th>
      <th id="cell-1-6" rowspan="3"style="border: 0.5px solid black;font-size: 12px;">सड़क मील<br>भत्ता के लिए<br>दूरी कि. मी. में <br>Distance in 
          Kms.<br>for road mileage </th>
      <th id="cell-1-7" colspan="2"rowspan="3"style="border: 0.5px solid black;font-size: 12px;">विश्राम की अवधि<br>Duration of Halt </th>
      <th id="cell-1-8" rowspan="3" drl="ltr"style="border: 0.5px solid black;writing-mode: vertical-rl; transform: rotate(-180deg);font-size: 12px;">यात्रा का प्रयोजन<br>Purpose of journey.</th>
    </tr>
      <tr>
        <th id="cell-2-1" rowspan="2" style="border: 0.5px solid black;text-align: center; vertical-align: middle;font-size: 12px;"> &nbsp; तारीख और <br>समय Date <br>And Time &nbsp;</th>
        <th id="cell-2-2" rowspan="2"style="border: 0.5px solid black;font-size: 12px;"> कहा से/Where From</th>
        <th id="cell-2-3" rowspan="2"style="border: 0.5px solid black;font-size: 12px;">तारीख और <br>समय Date <br>And Time</th>
        <th id="cell-2-4" rowspan="2"style="border: 0.5px solid black;font-size: 12px;">कहा तक /FROM To </th>
      </tr>
      <tr>
        <th id="cell-3-1"style="border: 0.5px solid black;font-size: 12px;">Rs.</th>
        <th id="cell-3-2"style="border: 0.5px solid black;font-size: 12px;">p.</th>
      </tr>
      
      <tr id="initial-travel-row" data-row-type="travel">
        <td id="cell-4-1" contenteditable="true" data-placeholder="DD.MM.YY HH:MM"></td>
        <td id="cell-4-2" contenteditable="true" data-placeholder="स्थान (From)"></td>
        <td id="cell-4-3" contenteditable="true" data-placeholder="DD.MM.YY HH:MM"></td>
        <td id="cell-4-4" contenteditable="true" data-placeholder="स्थान (To)"></td>
        <td id="cell-4-5" contenteditable="true" data-placeholder="Mode/Class"></td>
        <td id="cell-4-6" contenteditable="true" colspan="2" data-placeholder="Amount (₹)"></td>
        <td id="cell-4-7" contenteditable="true" data-placeholder="--"></td>
        <td id="cell-4-8" contenteditable="true" colspan="2" data-placeholder="--"></td>
        <td id="cell-4-9" contenteditable="true" rowspan="50" 
            data-placeholder="Purpose all journeys)" 
            style="vertical-align: top;">
        </td>
      </tr>
    </table>
    
    <div class="action-buttons" id="actionButtons" style="top: 105mm;"> 
        <button id="addTravelRow" style="font-size: 14px; padding: 5px 10px; cursor: pointer;">नया यात्रा विवरण जोड़ें (+)</button>
        <button id="addMergedRow" style="font-size: 14px; padding: 5px 10px; cursor: pointer;">नया विश्राम/हॉल्ट विवरण जोड़ें (+)</button>
        <button id="addTotalRow" style="font-size: 14px; padding: 5px 10px; cursor: pointer; background-color: #3f51b5; color: white; border: none;">कुल योग (₹) जोड़ें</button>
        <button id="deleteLastRow" style="font-size: 14px; padding: 5px 10px; cursor: pointer; background-color: #f44336; color: white; border: none;">आखिरी रो डिलीट करें (-)</button>
        <button id="downloadPdf" style="font-size: 14px; padding: 5px 10px; cursor: pointer; background-color: #4CAF50; color: white; border: none;">PDF डाउनलोड करें ⬇️</button>
    </div>
  </div>

  <!-- यहाँ फार्म के नीचे तीन A4 इमेज डिव जोड़े गए हैं -->

  <div class="a4-image-page">
    <img src="img1.jpg" style="width: 210mm; height: 297mm; object-fit: cover; display: block;" alt="Image 1" />
  </div>

  <div class="a4-image-page">
    <img src="img2.jpg" style="width: 210mm; height: 297mm; object-fit: cover; display: block;" alt="Image 2" />
  </div>

  <div class="a4-image-page">
    <img src="img3.jpg" style="width: 210mm; height: 297mm; object-fit: cover; display: block;" alt="Image 3" />
  </div>
<script>
    const table = document.getElementById('customTable');
    const actionButtons = document.getElementById('actionButtons');
    const a4Page = document.getElementById('a4Page');
    
    const MM_TO_PX = 3.779527559; 

    // **A. बटन और पेज की ऊंचाई को अपडेट करने का फ़ंक्शन**
    function updateLayout() {
        const tableOffsetTopPx = table.offsetTop; 
        const tableHeightPx = table.offsetHeight; 
        const newTopPx = tableOffsetTopPx + tableHeightPx + 10; 
        actionButtons.style.top = `${newTopPx}px`;

        const buttonsHeightPx = actionButtons.offsetHeight;
        const requiredHeightPx = newTopPx + buttonsHeightPx + 20;
        const a4MinHeightPx = 297 * MM_TO_PX;
        const finalHeight = Math.max(requiredHeightPx, a4MinHeightPx);
        a4Page.style.minHeight = `${finalHeight}px`;
    }

    // **B. ऑटो-स्क्रॉल फ़ंक्शन**
    function scrollToBottom() {
        window.scrollTo({
            top: document.body.scrollHeight,
            behavior: 'smooth'
        });
    }

    // **C. रो HTML स्ट्रिंग्स**
    const travelRowHTML = `
      <tr data-deletable="true" data-row-type="travel">
        <td contenteditable="true" data-placeholder="DD.MM.YY HH:MM"></td>
        <td contenteditable="true" data-placeholder="स्थान (From)"></td>
        <td contenteditable="true" data-placeholder="DD.MM.YY HH:MM"></td>
        <td contenteditable="true" data-placeholder="स्थान (To)"></td>
        <td contenteditable="true" data-placeholder="Mode/Class"></td>
        <td contenteditable="true" colspan="2" data-placeholder="Amount (₹)"></td>
        <td contenteditable="true" data-placeholder="--"></td>
        <td contenteditable="true" colspan="2" data-placeholder="--"></td>
      </tr>
    `;

    const mergedRowHTML = `
      <tr data-deletable="true" data-row-type="halt">
        <td colspan="9" 
            contenteditable="true" 
            style="border: 0.5px solid black; text-align: left; vertical-align: top; padding: 3px;"
            data-placeholder="विश्राम का स्थान और अवधि/Place and Duration of Halt">
        </td>
      </tr>
    `;
    
    // **D. योग रो HTML स्ट्रिंग**
    const totalRowHTML = (totalAmount) => `
        <tr data-row-type="total" class="total-row">
            <td colspan="5" style="text-align: right; border-right: none !important;">कुल योग / Total Amount</td>
            <td colspan="2" style="text-align: center; border-left: none !important;">${totalAmount.toFixed(2)}</td>
            <td colspan="4" style="text-align: center;"></td> 
        </tr>
    `;

    // **E. योग गणना फ़ंक्शन**
    function calculateTotal() {
        let total = 0;
        const rows = table.querySelectorAll('tr[data-row-type="travel"]');
        
        rows.forEach(row => {
            const amountCell = row.cells[5]; 
            if (amountCell) {
                const rawText = amountCell.textContent.replace(/[^0-9.]/g, ''); 
                const amount = parseFloat(rawText) || 0;
                total += amount;
            }
        });
        return total;
    }
    
    // यह फंक्शन सभी उपयुक्त contenteditable सेल्स पर ऑटो-फॉर्मेटिंग लागू करता है।
    function applyDateAutoFormatting() {
        const dateCells = document.querySelectorAll('#customTable td[data-placeholder="DD.MM.YY HH:MM"]');
        dateCells.forEach(cell => {
            if (!cell.hasAttribute('data-formatted')) {
                cell.addEventListener('input', function() {
                    let value = this.textContent.trim().toUpperCase().replace(/[^0-9.]/g, '');
                    let newCursorPosition = value.length;
                    let originalLength = value.length;
                    if (originalLength > 2 && value[2] !== '.') {
                        value = value.slice(0, 2) + '.' + value.slice(2);
                    }
                    if (originalLength > 5 && value[5] !== '.') {
                        value = value.slice(0, 5) + '.' + value.slice(5);
                    }
                    if (originalLength > 8 && value[8] !== ' ') {
                       value = value.slice(0, 8) + ' ' + value.slice(8).replace(':', '');
                    }
                    if (originalLength > 11 && value[11] !== ':') {
                        value = value.slice(0, 11) + ':' + value.slice(11);
                    }
                    value = value.slice(0, 14); 
                    if (this.textContent !== value) {
                        this.textContent = value;
                        if (document.activeElement === this) {
                            let diff = value.length - originalLength;
                            newCursorPosition = newCursorPosition + diff;
                            const selection = window.getSelection();
                            const range = document.createRange();
                            if (this.firstChild) {
                                range.setStart(this.firstChild, Math.min(newCursorPosition, value.length));
                                range.collapse(true);
                                selection.removeAllRanges();
                                selection.addRange(range);
                            }
                        }
                    }
                });
                cell.setAttribute('data-formatted', 'true');
            }
        });
    }

    // **नंबर केवल इनपुट के लिए फ़ंक्शन (fare amount कॉलम)**
    function restrictNumberInput(cell) {
        cell.addEventListener('keydown', function(e) {
            const allowedKeys = [8,9,37,38,39,40,46,110,190];
            if (
                (e.keyCode >= 48 && e.keyCode <= 57) ||
                (e.keyCode >= 96 && e.keyCode <= 105) ||
                allowedKeys.includes(e.keyCode)
            ) {
                return;
            }
            e.preventDefault();
        });

        cell.addEventListener('input', function() {
            let text = this.textContent;
            let newText = text.replace(/[^0-9.]/g, '');
            const parts = newText.split('.');
            if (parts.length > 2) {
                newText = parts[0] + '.' + parts.slice(1).join('');
            }
            if (newText !== text) {
                this.textContent = newText;
                const selection = window.getSelection();
                const range = document.createRange();
                if (this.firstChild) {
                    range.setStart(this.firstChild, newText.length);
                    range.collapse(true);
                    selection.removeAllRanges();
                    selection.addRange(range);
                }
            }
        });
    }

    // इवेंट लिसनर्स सेट करें

    // पेज लोड पर, सभी मौजूदा fare amount कॉलम पर नंबर-केवल इनपुट लगाएं और डेट फॉर्मेटिंग शुरू करें
    document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('#customTable td[data-placeholder="Amount (₹)"]').forEach(restrictNumberInput);
        applyDateAutoFormatting();

        const modal = document.getElementById('instructionModal');
        const closeButton = document.getElementById('closeModalButton');
        modal.style.display = 'flex'; // डायलॉग बॉक्स दिखाएं

        closeButton.addEventListener('click', function() {
            modal.style.display = 'none'; // डायलॉग बॉक्स छुपाएं
            updateLayout();
            window.onresize = updateLayout;
        });
    });

    document.getElementById('addTravelRow').addEventListener('click', function() {
        const newRow = table.insertRow(-1); 
        newRow.outerHTML = travelRowHTML;
        updateLayout();
        applyDateAutoFormatting();

        // नई जोड़ी गई रो के fare amount सेल पर नंबर-इनपुट लिमिट लगाएं
        const lastRow = table.querySelector('tr[data-deletable="true"]:last-child');
        if (lastRow) {
            const fareCell = lastRow.querySelector('td[data-placeholder="Amount (₹)"]');
            if(fareCell) {
                restrictNumberInput(fareCell);
            }
        }
    });

    document.getElementById('addMergedRow').addEventListener('click', function() {
        const newRow = table.insertRow(-1); 
        newRow.outerHTML = mergedRowHTML;
        updateLayout();
    });

    document.getElementById('addTotalRow').addEventListener('click', function() {
        const existingTotalRow = table.querySelector('tr[data-row-type="total"]');
        if (existingTotalRow) {
            existingTotalRow.remove();
        }

        const totalAmount = calculateTotal();
        const newRow = table.insertRow(-1); 
        newRow.outerHTML = totalRowHTML(totalAmount);
        updateLayout();
    });
    
    document.getElementById('deleteLastRow').addEventListener('click', function() {
        const totalRows = table.rows.length;
        const fixedRows = 4;
        
        const lastRow = table.rows[totalRows - 1];
        const isTotalRow = lastRow && lastRow.getAttribute('data-row-type') === 'total';
        
        if (totalRows > fixedRows || isTotalRow) {
            table.deleteRow(totalRows - 1); 
            updateLayout(); 
        } else {
            alert("शुरुआती यात्रा विवरण रो को हटाया नहीं जा सकता।");
        }
    });

    document.getElementById('downloadPdf').addEventListener('click', function() {
        window.print();
    });
    document.querySelector('input[placeholder="01-18"]').addEventListener('input', function() {
  let val = parseInt(this.value);
  if (val > 18) {
    this.value = 18;
  } else if (val < 1) {
    this.value = 1;
  }
});
</script>
</body>

</html>



